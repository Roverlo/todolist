<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProjectTodo - 交付科定制版 (UI融合修复 V15)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* === 1. 视觉变量 === */
        :root {
            --primary-btn: #4f46e5; --primary-btn-hover: #4338ca;
            --bg-body: #eef2ff; --bg-sidebar: #e0e7ff; --bg-surface: #ffffff;
            --text-main: #1f2937; --text-subtle: #6b7280; --link-color: #6366f1;
            --border-color: #e5e7eb; --radius: 12px;
            --primary-soft: #eff6ff;
            
            /* 状态色 */
            --tag-doing-bg: #eff6ff; --tag-doing-text: #3b82f6; --tag-doing-border: #bfdbfe;
            --tag-high-bg: #fff7ed; --tag-high-text: #ea580c; --tag-high-border: #fed7aa;
            
            /* 选中状态 */
            --nav-active-bg: #ffffff; --nav-active-border: #4f46e5; --nav-active-text: #4f46e5;
        }

        /* 主题覆盖 */
        [data-theme='sky'] { --primary-btn: #0284c7; --bg-body: #f0f9ff; --bg-sidebar: #e0f2fe; --link-color: #0ea5e9; --primary-soft: #f0f9ff; }
        [data-theme='rose'] { --primary-btn: #e11d48; --bg-body: #fff1f2; --bg-sidebar: #ffe4e6; --link-color: #f43f5e; --primary-soft: #fff1f2; }
        [data-theme='indigo'] { --primary-btn: #4f46e5; --bg-body: #eef2ff; --bg-sidebar: #e0e7ff; --link-color: #6366f1; --primary-soft: #eef2ff; }

        /* 全局平滑过渡 */
        body, .app-window, .sidebar, .btn-primary, .btn-outline, .btn-new-proj,
        .nav-item, .nav-item.active, .nav-icon-box, .nav-count,
        .project-card, .tag, .priority-bar, .check-icon, .theme-color-dot {
            transition: background-color 0.8s cubic-bezier(0.4, 0, 0.2, 1), 
                        color 0.8s cubic-bezier(0.4, 0, 0.2, 1), 
                        border-color 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                        box-shadow 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            margin: 0; height: 100vh; width: 100vw; background: #111827;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            display: flex; justify-content: center; align-items: center; overflow: hidden; user-select: none;
        }

        /* === 适配容器 === */
        #layout-stage {
            width: 1300px; height: 850px;
            display: flex; justify-content: center; align-items: center;
            transform-origin: center center;
        }

        /* === 2. 窗口容器 === */
        .app-window {
            width: 100%; height: 100%; background: var(--bg-body);
            border-radius: 12px; box-shadow: 0 0 0 1px rgba(255,255,255,0.1), 0 50px 100px rgba(0,0,0,0.5);
            display: grid; grid-template-columns: 240px 1fr;
            overflow: hidden; position: relative; transform: scale(0.95); opacity: 0;
            transition: transform 0.8s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.8s ease, background-color 0.8s ease;
        }
        .app-window.open { opacity: 1; transform: scale(1); }

        /* === 3. 侧边栏 === */
        .sidebar {
            background: var(--bg-sidebar); padding: 20px; display: flex; flex-direction: column; gap: 20px;
            border-right: 1px solid rgba(0,0,0,0.05);
        }
        .user-card { display: flex; gap: 12px; align-items: center; margin-bottom: 10px; }
        .avatar { width: 48px; height: 48px; background: #4f46e5; border-radius: 50%; color: white; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: bold; transition: background-color 0.8s ease; }
        .user-info h3 { margin: 0; font-size: 16px; color: var(--text-main); }
        .user-info p { margin: 2px 0 0; font-size: 12px; color: var(--text-subtle); }

        .nav-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px 16px; border-radius: 16px; border: 1px solid transparent;
            background: rgba(255,255,255,0.5);
            color: var(--text-subtle); cursor: pointer; transition: all 0.2s; margin-bottom: 10px;
        }
        .nav-item.active {
            background: var(--nav-active-bg); border-color: var(--nav-active-border); color: var(--nav-active-text);
            font-weight: 600; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .nav-icon-box { 
            width: 36px; height: 36px; border-radius: 8px; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 16px; font-weight: bold; margin-right: 12px;
            border: 1px solid currentColor;
        }
        .nav-text-col { display: flex; flex-direction: column; justify-content: center; }
        .nav-hint { font-size: 10px; color: #9ca3af; font-weight: normal; margin-top: 2px; }
        .nav-count { background: rgba(0,0,0,0.05); padding: 4px 10px; border-radius: 99px; font-size: 12px; font-weight:600; }
        .nav-item.active .nav-count { background: #eef2ff; color: #4f46e5; }

        .section-title { font-size: 14px; color: var(--text-subtle); margin-bottom: 10px; }
        
        /* === 优化后的项目输入区 (V15 Integrated) === */
        .project-input-group { 
            position: relative;
            margin-bottom: 15px;
            width: 100%;
        }
        .project-input { 
            width: 100%; 
            border: 1px solid #d1d5db; 
            border-radius: 20px; 
            padding: 9px 56px 9px 16px; /* 右侧留出按钮空间 */
            outline: none; 
            font-size: 13px; 
            background: white;
            transition: all 0.2s;
            height: 38px; 
            box-sizing: border-box;
        }
        .project-input:focus { border-color: var(--primary-btn); box-shadow: 0 0 0 2px var(--primary-soft); }
        
        .btn-new-proj { 
            position: absolute;
            right: 5px;
            top: 5px;
            bottom: 5px;
            padding: 0 12px;
            border-radius: 14px; 
            border: none; 
            color: var(--primary-btn); 
            background: var(--primary-soft); 
            font-size: 12px; 
            cursor: pointer; 
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
            font-weight: 600;
            opacity: 0.9;
        }
        .btn-new-proj:hover { opacity: 1; background: #dbeafe; }
        .btn-new-proj:active { transform: scale(0.95); }


        .project-card {
            background: rgba(255,255,255,0.5); padding: 12px; border-radius: 12px; margin-bottom: 10px;
            display: flex; justify-content: space-between; align-items: center; border: 1px solid transparent; cursor: pointer;
        }
        .project-card:hover { background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .project-name { font-size: 14px; font-weight: 600; color: var(--text-main); }
        .project-count { font-size: 11px; color: #6b7280; }
        .project-actions { display: flex; gap: 4px; opacity: 0; transition: opacity 0.2s; }
        .project-card:hover .project-actions { opacity: 1; }
        .action-badge { font-size: 10px; padding: 2px 6px; border-radius: 4px; cursor: pointer; }
        .badge-blue { background: #eff6ff; color: #3b82f6; }
        .badge-red { background: #fef2f2; color: #ef4444; }

        /* === 4. 主内容区 === */
        .main { padding: 20px 30px; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; }
        .top-bar { display: flex; justify-content: space-between; align-items: center; }
        .page-title { font-size: 20px; font-weight: 700; color: var(--text-main); display: flex; align-items: baseline; gap: 10px; }
        .page-meta { font-size: 12px; color: #6b7280; font-weight: normal; }
        
        .btn-primary { background: var(--primary-btn); color: white; padding: 8px 20px; border-radius: 20px; border: none; font-weight: 600; font-size: 13px; cursor: pointer; box-shadow: 0 2px 4px rgba(79, 70, 229, 0.2); }
        .btn-outline { background: white; color: #4f46e5; border: 1px solid #c7d2fe; padding: 8px 20px; border-radius: 20px; font-weight: 600; font-size: 13px; cursor: pointer; }

        /* 筛选区 */
        .filter-panel { background: white; border-radius: 16px; padding: 16px 24px; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .filter-row-1 { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .filter-label-main { font-size: 14px; font-weight: 700; color: #1f2937; margin-right: 20px; }
        .status-tabs { background: #f3f4f6; padding: 4px; border-radius: 8px; display: inline-flex; }
        .status-tab { padding: 4px 16px; font-size: 12px; color: #6b7280; border-radius: 6px; cursor: pointer; }
        .status-tab.active { background: white; color: #1f2937; font-weight: 600; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .clear-filter { font-size: 12px; color: #3b82f6; cursor: pointer; }
        
        .filter-row-2 { display: flex; gap: 20px; }
        .filter-col { flex: 1; position: relative; }
        .filter-label-sm { font-size: 12px; color: #9ca3af; margin-bottom: 6px; }
        
        /* 模拟下拉框 */
        .filter-select-sim { 
            width: 100%; padding: 8px 12px; border: 1px solid #e5e7eb; border-radius: 8px; 
            font-size: 13px; color: #374151; background: white; box-sizing: border-box;
            display: flex; justify-content: space-between; align-items: center; cursor: pointer;
            transition: all 0.2s;
        }
        .filter-select-sim:after { 
            content: ''; width: 16px; height: 16px; 
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%239ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>');
            background-repeat: no-repeat; background-position: center;
        }
        .filter-select-sim.active { 
            border-color: #4f46e5; box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); 
        }
        
        .filter-input-native { width: 100%; padding: 8px 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 13px; outline: none; box-sizing: border-box; color: #374151; font-family: inherit; }

        /* 自定义下拉菜单 */
        .dropdown-menu {
            position: absolute; top: 105%; left: 0; width: 100%; 
            background: white; border: 1px solid #e5e7eb; border-radius: 8px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            z-index: 50; display: none; flex-direction: column; overflow: hidden;
            padding: 4px;
        }
        .dropdown-menu.show { display: flex; animation: scaleIn 0.15s cubic-bezier(0.16, 1, 0.3, 1); }
        .dropdown-item { 
            padding: 8px 12px; font-size: 13px; color: #374151; cursor: pointer; 
            display: flex; justify-content: space-between; border-radius: 6px;
            margin-bottom: 2px;
        }
        .dropdown-item:last-child { margin-bottom: 0; }
        .dropdown-item.hover { background: #f3f4f6; }
        .dropdown-item.selected { 
            background: var(--primary-soft); color: var(--primary-btn); font-weight: 600; 
        }
        
        @keyframes scaleIn { from { opacity: 0; transform: translateY(-5px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }


        /* 任务看板 */
        .task-header { display: grid; grid-template-columns: 3fr 2fr 2fr 2fr 2fr; gap: 10px; background: #e0e7ff; padding: 10px 20px; border-radius: 8px 8px 0 0; font-size: 12px; font-weight: 600; color: #4338ca; }
        .group-header { display: flex; align-items: center; gap: 8px; margin: 20px 0 10px 0; font-size: 13px; font-weight: 600; color: #374151; }
        .dot-red { width: 12px; height: 12px; background: #ef4444; border-radius: 50%; }
        
        .task-card {
            background: white; border-radius: 12px; padding: 0; display: grid; grid-template-columns: 4px 3fr 2fr 2fr 2fr 2fr; gap: 0;
            margin-bottom: 10px; box-shadow: 0 1px 2px rgba(0,0,0,0.05); overflow: hidden; border: 1px solid transparent; cursor: pointer; transition: all 0.2s;
        }
        .task-card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        .priority-bar { height: 100%; width: 4px; }
        .p-high { background: #f97316; } .p-normal { background: #3b82f6; }

        .task-col { padding: 16px; display: flex; flex-direction: column; justify-content: center; border-right: 1px solid #f9fafb; }
        .task-col:last-child { border-right: none; }
        .task-project-name { font-size: 11px; color: #9ca3af; margin-bottom: 4px; }
        .task-main-title { font-size: 14px; font-weight: 700; color: #111827; margin-bottom: 8px; }
        .task-tags { display: flex; gap: 6px; }
        .tag { font-size: 11px; padding: 2px 6px; border-radius: 4px; border: 1px solid; }
        .tag-doing { background: var(--tag-doing-bg); color: var(--tag-doing-text); border-color: var(--tag-doing-border); }
        .tag-high { background: var(--tag-high-bg); color: var(--tag-high-text); border-color: var(--tag-high-border); }
        .text-placeholder { font-size: 12px; color: #d1d5db; }
        .task-meta { font-size: 11px; color: #6b7280; line-height: 1.4; }
        .task-actions { display: flex; justify-content: flex-end; gap: 6px; margin-top: 8px; }
        .action-btn { padding: 2px 8px; border-radius: 4px; font-size: 11px; background: #f3f4f6; color: #4b5563; border: none; cursor: pointer; }

        /* === 5. 弹窗 (Modal) === */
        .modal-overlay {
            position: absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(2px);
            z-index: 100; display: none; justify-content: center; align-items: center;
        }
        .modal-overlay.active { display: flex; }
        .modal-window {
            background: white; border-radius: 16px; width: 950px; max-width: 90%; max-height: 90vh; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            overflow: hidden; display: flex; flex-direction: column; transform: scale(0.95); transition: transform 0.3s;
        }
        .modal-overlay.active .modal-window { transform: scale(1); }
        
        .modal-header { padding: 16px 24px; border-bottom: 1px solid #f3f4f6; display: flex; justify-content: space-between; flex-shrink: 0; }
        .modal-title { font-size: 18px; font-weight: 700; color: #111827; }
        .modal-body { padding: 24px; overflow-y: auto; flex: 1; min-height: 0; }
        .label-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
        .form-label { font-size: 12px; color: #6b7280; font-weight: 500; }
        .label-link { font-size: 12px; color: var(--link-color); cursor: pointer; text-decoration: none; }
        .label-link:hover { text-decoration: underline; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 16px; }
        .form-full { margin-bottom: 16px; }
        .form-input { width: 100%; padding: 10px 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px; box-sizing: border-box; outline: none; }
        .form-input:focus { border-color: #4f46e5; box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }
        .form-textarea { width: 100%; height: 80px; resize: none; font-family: inherit; }
        .top-hint { font-size: 12px; color: #6366f1; background: #eef2ff; padding: 8px 12px; border-radius: 6px; margin-bottom: 20px; }
        .modal-footer { padding: 15px 30px; background: #f9fafb; border-top: 1px solid #f3f4f6; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
        .footer-hint { font-size: 11px; color: #9ca3af; }

        /* 主题列表 */
        .theme-list { display: flex; flex-direction: column; gap: 10px; }
        .theme-item { display: flex; align-items: center; padding: 12px; border-radius: 8px; cursor: pointer; transition: background 0.2s; border: 1px solid transparent; }
        .theme-item:hover { background: #f9fafb; }
        .theme-item.active { background: #eff6ff; border-color: #c7d2fe; }
        .theme-color-dot { width: 32px; height: 32px; border-radius: 50%; margin-right: 16px; }
        .theme-text h4 { margin: 0; font-size: 14px; color: #1f2937; }
        .theme-text p { margin: 2px 0 0; font-size: 11px; color: #6b7280; }
        .check-icon { margin-left: auto; color: #4f46e5; opacity: 0; }
        .theme-item.active .check-icon { opacity: 1; }

        /* === 6. 交互逻辑 === */
        .cursor {
            width: 24px; height: 24px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="black" stroke="white" stroke-width="2" viewBox="0 0 24 24"><path d="M5.5 3.21V20.8c0 .45.54.67.85.35l4.86-4.86a.5.5 0 0 1 .35-.15h6.87a.5.5 0 0 0 .35-.85L6.35 2.85a.5.5 0 0 0-.85.36z"/></svg>') no-repeat;
            position: fixed; z-index: 9999; pointer-events: none;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3)); transition: transform 0.1s;
        }
        .cursor.click { transform: scale(0.8); }
        
        .subtitle {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            font-size: 20px; color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            background: rgba(0,0,0,0.6); padding: 8px 20px; border-radius: 20px;
            opacity: 0; transition: opacity 0.5s; z-index: 10000;
        }

        /* === 8. Toast 消息提示 === */
        .toast-container {
            position: fixed; top: 80px; left: 50%; transform: translateX(-50%);
            z-index: 2000; display: flex; flex-direction: column; gap: 10px;
        }
        .toast {
            background: rgba(0, 0, 0, 0.8); color: white; padding: 10px 20px; border-radius: 8px;
            font-size: 14px; display: flex; align-items: center; gap: 8px;
            opacity: 0; transform: translateY(-20px); transition: all 0.3s;
        }
        .toast.show { opacity: 1; transform: translateY(0); }
        .toast-icon-success { color: #4ade80; }


        /* === 7. 开场动画 (Intro) === */
        .intro-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #111827; z-index: 20000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            font-family: "Microsoft YaHei", sans-serif;
            transition: opacity 1s;
        }
        .intro-content { width: 800px; max-width: 90%; }
        .chat-bubble {
            background: #1f2937; border-radius: 12px; padding: 20px; margin-bottom: 24px;
            color: #e5e7eb; font-size: 18px; line-height: 1.6;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            opacity: 0; transform: translateY(20px); transition: all 0.5s;
            position: relative;
        }
        .chat-bubble.show { opacity: 1; transform: translateY(0); }
        .chat-bubble.user { border-left: 4px solid #ef4444; }
        .chat-bubble.ai { border-left: 4px solid #4f46e5; background: #1e1b4b; color: #e0e7ff; }
        
        .avatar-icon {
            position: absolute; left: -50px; top: 0; width: 40px; height: 40px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-weight: bold; color: white;
        }
        .avatar-user { background: #ef4444; }
        .avatar-ai { background: #4f46e5; }

        .typing-cursor::after { content: '|'; animation: blink 1s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        .logo-reveal {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 48px; font-weight: 800; color: white;
            opacity: 0; letter-spacing: 4px;
            text-shadow: 0 0 20px rgba(79, 70, 229, 0.6);
            transition: all 1s;
        }
        .logo-reveal.show { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }

        /* === 9. 结尾动画 (Outro) === */
        .outro-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #111827; z-index: 20001;
            display: none; flex-direction: column; justify-content: center; align-items: center;
            opacity: 0; transition: opacity 1.5s ease;
            font-family: "Microsoft YaHei", sans-serif;
        }
        .outro-text-1 {
            font-size: 32px; font-weight: 400; color: #9ca3af;
            margin-bottom: 20px; opacity: 0; transform: translateY(20px);
            transition: all 1s ease; letter-spacing: 4px;
        }
        .outro-text-2 {
            font-size: 64px; font-weight: 900; color: white;
            background: linear-gradient(135deg, #fff 0%, #a5b4fc 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            opacity: 0; transform: scale(0.9); letter-spacing: 8px;
            transition: all 1.5s cubic-bezier(0.16, 1, 0.3, 1);
            text-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .outro-logo {
            margin-top: 60px; font-size: 16px; color: #4f46e5;
            opacity: 0; transition: opacity 1s;
            display: flex; align-items: center; gap: 10px;
        }
        .outro-logo::before, .outro-logo::after {
            content: ""; width: 40px; height: 1px; background: #312e81;
        }

    </style>
</head>
<body data-theme="sky">

    <!-- 开场动画层 -->
    <div class="intro-layer" id="intro-layer">
        <div class="logo-reveal" id="logo-reveal">ProjectTodo</div>
        <div class="intro-content" id="intro-content">
            <div class="chat-bubble user" id="q-bubble">
                <div class="avatar-icon avatar-user">问</div>
                <div id="q-text"></div>
            </div>
            <div class="chat-bubble ai" id="a-bubble">
                <div class="avatar-icon avatar-ai">答</div>
                <div id="a-text"></div>
            </div>
        </div>
    </div>

    <!-- 结尾动画层 -->
    <div class="outro-layer" id="outro-layer">
        <div class="outro-text-1" id="outro-text-1">网络服务处</div>
        <div class="outro-text-2" id="outro-text-2">视频交付科</div>
        <div class="outro-logo" id="outro-logo">ProjectTodo</div>
    </div>

    <!-- 1. 新建单次任务弹窗 -->
    <div class="modal-overlay" id="modal-single">
        <div class="modal-window">
            <div class="modal-header">
                <div class="modal-title">新建单次任务</div>
                <div style="cursor:pointer; color:#9ca3af">✕</div>
            </div>
            <div class="modal-body">
                <div class="top-hint">选择所属项目，补充关键信息，创建后会出现在当前项目的任务列表中。</div>
                <div class="label-row">
                    <label class="form-label">基本信息</label>
                    <span class="label-link">先把任务的标签补全，后续筛选、排序会更好用。</span>
                </div>
                <div class="form-grid">
                    <div>
                        <label class="form-label">项目 *</label>
                        <select class="form-input"><option>回收站</option><option>未分类</option></select>
                    </div>
                    <div>
                        <label class="form-label">状态 *</label>
                        <select class="form-input"><option>进行中</option><option>待办</option></select>
                    </div>
                </div>
                <div class="form-full">
                    <label class="form-label">标题 *</label>
                    <input type="text" class="form-input" id="input-title-1" placeholder="请填写任务标题，建议 10-50 字，突出动词和对象">
                </div>
                <div class="form-grid">
                    <div>
                        <label class="form-label">优先级 *</label>
                        <select class="form-input"><option>中</option><option>高</option></select>
                    </div>
                    <div>
                        <label class="form-label">截止日期</label>
                        <input type="date" class="form-input" placeholder="yyyy/mm/dd">
                    </div>
                </div>
                <div class="form-grid">
                    <div>
                        <label class="form-label">现场责任人</label>
                        <input type="text" class="form-input" placeholder="例如：张三">
                    </div>
                    <div>
                        <label class="form-label">产线责任人</label>
                        <input type="text" class="form-input" placeholder="例如：李四">
                    </div>
                </div>
                <div class="form-full">
                    <div class="label-row">
                        <label class="form-label">详情</label>
                        <span class="label-link">简单说明要做什么，涉及哪些环境或人员。</span>
                    </div>
                    <textarea class="form-input form-textarea" placeholder="例如：整理本月现场支持过程中遇到的典型问题，并输出一篇维护经验文档。"></textarea>
                </div>
                <div class="form-full">
                    <div class="label-row">
                        <label class="form-label">下一步计划</label>
                        <span class="label-link">可以先写一个最近要推进的动作，后续在任务详情里再补充。</span>
                    </div>
                    <textarea class="form-input form-textarea" placeholder="例如：本周五前完成需求确认，下周一前输出初版文档。"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <div class="footer-hint">带星号为必填字段，创建片可在任务详情中继续完善。</div>
                <div style="display:flex; gap:10px;">
                    <button class="btn-outline" style="border:none; color:#6b7280;">取消</button>
                    <button class="btn-primary" id="btn-submit-1">提交</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 2. 新建周期任务弹窗 -->
    <div class="modal-overlay" id="modal-recurring">
        <div class="modal-window">
            <div class="modal-header">
                <div class="modal-title">新建周期任务</div>
                <div style="cursor:pointer; color:#9ca3af">✕</div>
            </div>
            <div class="modal-body">
                <div class="top-hint">适合布置例会、月度报表等固定节奏的工作，系统会按规则自动生成后续任务。</div>
                <div class="label-row">
                    <label class="form-label">基本信息</label>
                    <span class="label-link">先把任务的标签补全，后续筛选、排序会更好用。</span>
                </div>
                <div class="form-full">
                    <label class="form-label">名称 (用于列表展示) *</label>
                    <input type="text" class="form-input" id="input-title-2" placeholder="例如：周例会检查清单">
                </div>
                <div class="form-grid">
                    <div>
                        <label class="form-label">优先级 *</label>
                        <select class="form-input"><option>中</option></select>
                    </div>
                    <div>
                        <label class="form-label">默认现场责任人</label>
                        <input type="text" class="form-input" placeholder="新建任务时自动带入，可在单条任务中修改">
                    </div>
                </div>
                <div class="form-grid">
                    <div>
                        <label class="form-label">默认产线责任人</label>
                        <input type="text" class="form-input" placeholder="例如：产线联络人 / 协作同事">
                    </div>
                    <div>
                        <label class="form-label">状态 *</label>
                        <select class="form-input"><option>进行中</option></select>
                    </div>
                </div>
                <div class="label-row">
                    <label class="form-label">计划周期</label>
                    <span class="label-link">设置生成新任务的频率和截止日期规则。</span>
                </div>
                <div class="form-grid">
                    <div>
                        <label class="form-label">频率 *</label>
                        <select class="form-input"><option>每周</option></select>
                    </div>
                    <div>
                        <label class="form-label">截止日期</label>
                        <select class="form-input"><option>周一</option></select>
                    </div>
                </div>
                <div class="form-full">
                    <label style="font-size:13px; display:flex; align-items:center; gap:8px; color:#4b5563">
                        <input type="checkbox" checked style="width:16px; height:16px;"> 完成后自动续期 <span style="font-size:12px; color:#9ca3af">本期任务完成后，系统自动生成下一期任务。</span>
                    </label>
                </div>
                <div class="label-row">
                    <label class="form-label">默认任务内容</label>
                    <span class="label-link">每次生成的任务预填常用信息，可在单条任务中微调。</span>
                </div>
                <div class="form-full">
                    <label class="form-label">详情</label>
                    <textarea class="form-input form-textarea" placeholder="例如：本周例检查机房云桌面运行状态，汇总异常并反馈。"></textarea>
                </div>
                <div class="form-full">
                    <label class="form-label">下一步计划</label>
                    <textarea class="form-input form-textarea" placeholder="例如：完成检查后，在小组群内同步结果，并约定整改截止时间。"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <div class="footer-hint">创建后会生成当前一期任务，后续任务会按规则自动生成，可在任务详情页调整。</div>
                <div style="display:flex; gap:10px;">
                    <button class="btn-outline" style="border:none; color:#6b7280;">取消</button>
                    <button class="btn-primary" id="btn-submit-2">生成周期任务</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 3. 主题选择弹窗 -->
    <div class="modal-overlay" id="modal-theme">
        <div class="modal-window" style="width: 400px;">
            <div class="modal-header">
                <div class="modal-title">外观主题</div>
                <div style="cursor:pointer; color:#9ca3af">✕</div>
            </div>
            <div class="modal-body">
                <div class="top-hint" style="background:white; padding:0; margin-bottom:10px; color:#6b7280;">选择你喜欢的界面风格</div>
                <div class="theme-list">
                    <div class="theme-item" id="theme-sky">
                        <div class="theme-color-dot" style="background:#0ea5e9"></div>
                        <div class="theme-text"><h4>经典蓝</h4><p>专业、冷静 (默认)</p></div>
                        <div class="check-icon">✓</div>
                    </div>
                    <div class="theme-item" id="theme-green">
                        <div class="theme-color-dot" style="background:#10b981"></div>
                        <div class="theme-text"><h4>清新绿</h4><p>自然、护眼</p></div>
                        <div class="check-icon">✓</div>
                    </div>
                    <div class="theme-item" id="theme-purple">
                        <div class="theme-color-dot" style="background:#8b5cf6"></div>
                        <div class="theme-text"><h4>优雅紫</h4><p>创意、灵动</p></div>
                        <div class="check-icon">✓</div>
                    </div>
                    <div class="theme-item" id="theme-orange">
                        <div class="theme-color-dot" style="background:#f97316"></div>
                        <div class="theme-text"><h4>活力橙</h4><p>温暖、积极</p></div>
                        <div class="check-icon">✓</div>
                    </div>
                    <div class="theme-item" id="theme-black">
                        <div class="theme-color-dot" style="background:#1f2937"></div>
                        <div class="theme-text"><h4>极简黑</h4><p>专注、极致</p></div>
                        <div class="check-icon">✓</div>
                    </div>
                    <div class="theme-item" id="theme-sky-2">
                        <div class="theme-color-dot" style="background:#0284c7"></div>
                        <div class="theme-text"><h4>天空蓝</h4><p>通透、明快</p></div>
                        <div class="check-icon">✓</div>
                    </div>
                    <div class="theme-item" id="theme-rose">
                        <div class="theme-color-dot" style="background:#e11d48"></div>
                        <div class="theme-text"><h4>樱花粉</h4><p>治愈、温暖</p></div>
                        <div class="check-icon">✓</div>
                    </div>
                    <div class="theme-item" id="theme-indigo">
                        <div class="theme-color-dot" style="background:#4f46e5"></div>
                        <div class="theme-text"><h4>深邃靛</h4><p>沉稳、商务</p></div>
                        <div class="check-icon">✓</div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Toast 容器 -->
    <div class="toast-container" id="toast-container"></div>

    <!-- 主窗口 (Wrapped for Scaling) -->
    <div id="layout-stage">
        <div class="app-window" id="window">
            <!-- 左侧边栏 -->
            <div class="sidebar">
                <div class="user-card">
                    <div class="avatar">待</div>
                    <div class="user-info">
                        <h3>待办事项</h3>
                        <p>网络服务处视频交付科</p>
                    </div>
                </div>
                
                <div>
                    <div class="section-title">系统视图</div>
                    <div class="nav-item active" id="nav-all">
                        <div style="display:flex; align-items:center;">
                            <div class="nav-icon-box" style="color:#4f46e5; border-color:#c7d2fe; background:#eef2ff">汇</div>
                            <div class="nav-text-col"><span>汇总</span></div>
                        </div>
                        <div class="nav-count">7 项</div>
                    </div>
                    <div class="nav-item">
                        <div style="display:flex; align-items:center;">
                            <div class="nav-icon-box" style="color:#6b7280; border-color:#e5e7eb; background:white">未</div>
                            <div class="nav-text-col"><span>未分类</span></div>
                        </div>
                        <div class="nav-count">1 项</div>
                    </div>
                    <div class="nav-item" id="nav-trash">
                        <div style="display:flex; align-items:center;">
                            <div class="nav-icon-box" style="color:#ef4444; border-color:#fecaca; background:#fef2f2">回</div>
                            <div class="nav-text-col"><span>回收站</span><span class="nav-hint">保留 30 天</span></div>
                        </div>
                        <div class="nav-count">0 项</div>
                    </div>
                </div>

                <div style="flex:1;">
                    <div class="section-title">项目列表</div>
                    <div class="project-input-group">
                        <input class="project-input" placeholder="输入新项目名称...">
                        <button class="btn-new-proj">新建</button>
                    </div>
                    <div class="project-card" id="proj-1">
                        <div class="project-info"><div class="project-name">小组管理</div><div class="project-count">1 条任务</div></div>
                        <div class="project-actions"><div class="action-badge badge-blue">重命名</div><div class="action-badge badge-red">删除</div></div>
                    </div>
                    <div class="project-card" id="proj-2">
                        <div class="project-info"><div class="project-name">月度考核</div><div class="project-count">4 条任务</div></div>
                        <div class="project-actions"><div class="action-badge badge-blue">重命名</div><div class="action-badge badge-red">删除</div></div>
                    </div>
                    <div class="project-card" id="proj-3">
                        <div class="project-info"><div class="project-name">浦银RPA</div><div class="project-count">1 条任务</div></div>
                        <div class="project-actions"><div class="action-badge badge-blue">重命名</div><div class="action-badge badge-red">删除</div></div>
                    </div>
                </div>
            </div>

            <!-- 右侧内容区 -->
            <div class="main">
                <div class="top-bar">
                    <div class="page-title">任务看板 <span class="page-meta">共 5 条 · 按截止时间升序</span></div>
                    <div class="top-actions">
                        <button class="btn-primary" id="btn-new-single">新建单次任务</button>
                        <button class="btn-primary" id="btn-new-recurring">新建周期任务</button>
                        <button class="btn-outline">导出</button>
                        <button class="btn-outline" id="btn-theme">主题</button>
                    </div>
                </div>

                <!-- 筛选区 -->
                <div class="filter-panel">
                    <div class="filter-row-1">
                        <div style="display:flex; align-items:center;">
                            <span class="filter-label-main">筛选</span>
                            <div class="status-tabs">
                                <div class="status-tab active">进行中</div>
                                <div class="status-tab">挂起</div>
                                <div class="status-tab">已完成</div>
                            </div>
                        </div>
                        <span class="clear-filter">清空筛选</span>
                    </div>
                    <div class="filter-row-2">
                        <div class="filter-col">
                            <div class="filter-label-sm">当前阶段</div>
                            <div class="filter-select-sim">全部</div>
                        </div>
                        <!-- 优先级筛选 -->
                        <div class="filter-col" id="filter-wrapper-priority">
                            <div class="filter-label-sm">优先级</div>
                            <div class="filter-select-sim" id="filter-priority">全部</div>
                            <!-- 隐藏下拉菜单 -->
                            <div class="dropdown-menu" id="dropdown-priority">
                                <div class="dropdown-item selected">全部</div>
                                <div class="dropdown-item" id="option-high">高</div>
                                <div class="dropdown-item">中</div>
                                <div class="dropdown-item">低</div>
                            </div>
                        </div>
                        <div class="filter-col">
                            <div class="filter-label-sm">现场责任人</div>
                            <div class="filter-select-sim">全部</div>
                        </div>
                        <div class="filter-col">
                            <div class="filter-label-sm">产线责任人</div>
                            <div class="filter-select-sim">全部</div>
                        </div>
                        <div class="filter-col">
                            <div class="filter-label-sm">截止日期 起</div>
                            <input type="date" class="filter-input-native">
                        </div>
                        <div class="filter-col">
                            <div class="filter-label-sm">截止日期 止</div>
                            <input type="date" class="filter-input-native">
                        </div>
                    </div>
                </div>

                <!-- 任务列表容器 -->
                <div class="task-board">
                    <div class="task-header">
                        <div>项目 / 标题</div>
                        <div>详情</div>
                        <div>最近进展</div>
                        <div>下一步计划</div>
                        <div>状态 / 时间 / 操作</div>
                    </div>

                    <!-- CRITICAL: All dynamic task content goes here -->
                    <div id="task-list-content">
                        <!-- Initial State: Summary View -->
                        <div class="group-header">
                            <div class="dot-red"></div> 紧急区 (逾期/今日)
                        </div>
                        <!-- 任务 1 -->
                        <div class="task-card">
                            <div class="priority-bar p-high"></div>
                            <div class="task-col"><div class="task-project-name">月度考核</div><div class="task-main-title">提交可服需求</div><div class="task-tags"><span class="tag tag-doing">进行中</span><span class="tag tag-high">中优</span></div></div>
                            <div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div>
                            <div class="task-col"><div class="task-meta">创建 11-23 00:37</div><div class="task-meta">截止 逾期 2 天</div><div class="task-actions"><button class="action-btn">编辑</button><button class="action-btn" style="color:#ef4444; background:#fef2f2">删除</button></div></div>
                        </div>
                        <!-- 任务 2 -->
                        <div class="task-card">
                            <div class="priority-bar p-high"></div>
                            <div class="task-col"><div class="task-project-name">浦银RPA</div><div class="task-main-title">RPA环境云桌面交付启动</div><div class="task-tags"><span class="tag tag-doing">进行中</span><span class="tag tag-high">中优</span></div></div>
                            <div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div>
                            <div class="task-col"><div class="task-meta">创建 11-22 23:32</div><div class="task-meta">截止 剩余 8 天</div><div class="task-actions"><button class="action-btn">编辑</button><button class="action-btn" style="color:#ef4444; background:#fef2f2">删除</button></div></div>
                        </div>

                        <div class="group-header" style="margin-top:30px;">
                            <i class="fas fa-calendar icon-calendar"></i> 规划区 (未来)
                        </div>
                        
                        <!-- 任务 3 -->
                        <div class="task-card">
                            <div class="priority-bar p-normal"></div>
                            <div class="task-col"><div class="task-project-name">月度考核</div><div class="task-main-title">提交文档需求</div><div class="task-tags"><span class="tag tag-doing">进行中</span><span class="tag tag-high">中优</span></div></div>
                            <div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col" style="font-size:12px; color:#4b5563">需要写一篇云桌面相关的维护经验</div>
                            <div class="task-col"><div class="task-meta">创建 11-25 22:33</div><div class="task-meta">截止 剩余 28 天</div><div class="task-actions"><button class="action-btn">编辑</button><button class="action-btn" style="color:#ef4444; background:#fef2f2">删除</button></div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="cursor" id="cursor"></div>
    <div class="subtitle" id="subtitle"></div>

    <script>
        const cursor = document.getElementById('cursor');
        const subtitle = document.getElementById('subtitle');
        const stage = document.getElementById('layout-stage');

        function handleResize() {
            const targetW = 1350; // Add some buffer
            const targetH = 900; 
            const winW = window.innerWidth;
            const winH = window.innerHeight;
            
            const scaleX = winW / targetW;
            const scaleY = winH / targetH;
            
            // Use the smaller scale factor to ensure it fits
            let scale = Math.min(scaleX, scaleY);
            
            // Cap at 1.0 (don't scale up on huge screens)
            if (scale > 1) scale = 1;
            
            stage.style.transform = `scale(${scale})`;
        }

        window.addEventListener('resize', handleResize);
        // Call once on init
        handleResize();


        function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }
        async function move(selector, duration=800) {
            const el = document.querySelector(selector);
            if (!el) return;
            const rect = el.getBoundingClientRect();
            const x = rect.left + rect.width/2;
            const y = rect.top + rect.height/2;
            cursor.style.transition = `left ${duration}ms cubic-bezier(0.2, 0.8, 0.2, 1), top ${duration}ms cubic-bezier(0.2, 0.8, 0.2, 1)`;
            cursor.style.left = x + 'px';
            cursor.style.top = y + 'px';
            await sleep(duration + 100);
        }
        async function click() { cursor.classList.add('click'); await sleep(150); cursor.classList.remove('click'); }
        async function type(selector, text) {
            const input = document.querySelector(selector);
            input.focus();
            for(let c of text) { input.value += c; await sleep(50); }
        }
        function sub(text) { subtitle.textContent = text; subtitle.style.opacity = 1; }
        
        // Toast 工具
        function showToast(msg, type='success') {
            const container = document.getElementById('toast-container');
            const el = document.createElement('div');
            el.className = 'toast';
            el.innerHTML = `<i class="fas fa-check-circle toast-icon-${type}"></i> ${msg}`;
            container.appendChild(el);
            el.offsetHeight; el.classList.add('show');
            setTimeout(() => { el.classList.remove('show'); setTimeout(() => el.remove(), 300); }, 2000);
        }

        async function playIntro() {
            const qText = "作为一名普通员工，时常感觉任务数量多，轻重缓急难以区分，按月总结自己时也不能全面回想起重点工作，有什么方式方法可以在工服工作的事务管理里进行提升？希望总结一个方法（工具）具备分享团队和实际应用。";
            const aText = "这正是我开发 ProjectTodo 的初衷。\n\n我们需要一个既能“可视化区分优先级”，又能“自动沉淀工作流”的工具。\n不必在月底苦思冥想，每一条‘Done’的任务就是最好的业绩证明。\n\nProjectTodo —— 让工作井井有条，让价值清晰可见。";
            await sleep(800);
            document.getElementById('q-bubble').classList.add('show');
            const qEl = document.getElementById('q-text'); qEl.classList.add('typing-cursor');
            for(let i=0; i<qText.length; i++) { qEl.textContent += qText[i]; await sleep(30); }
            qEl.classList.remove('typing-cursor');
            await sleep(800);
            document.getElementById('a-bubble').classList.add('show');
            const aEl = document.getElementById('a-text'); aEl.classList.add('typing-cursor');
            for(let i=0; i<aText.length; i++) { aEl.innerText += aText[i]; await sleep(40); }
            aEl.classList.remove('typing-cursor');
            await sleep(2000);
            document.getElementById('intro-content').style.opacity = '0';
            await sleep(500);
            document.getElementById('logo-reveal').classList.add('show');
            await sleep(2000);
            document.getElementById('logo-reveal').style.opacity = '0';
            document.getElementById('intro-layer').style.opacity = '0';
            await sleep(1000);
            document.getElementById('intro-layer').style.display = 'none';
        }

        async function playOutro() {
            const outro = document.getElementById('outro-layer');
            outro.style.display = 'flex'; outro.offsetHeight; outro.style.opacity = '1';
            await sleep(500);
            document.getElementById('outro-text-1').style.opacity = '1';
            document.getElementById('outro-text-1').style.transform = 'translateY(0)';
            await sleep(1000);
            document.getElementById('outro-text-2').style.opacity = '1';
            document.getElementById('outro-text-2').style.transform = 'scale(1)';
            await sleep(1500);
            document.getElementById('outro-logo').style.opacity = '1';
            await sleep(3000);
        }

        async function run() {
            cursor.style.left = '110%'; cursor.style.top = '110%';
            
            await playIntro();
            await sleep(500);
            document.getElementById('window').classList.add('open');
            await sleep(1000);

            // 1. 新建单次任务
            sub("场景一：新建单次任务 (完整表单)");
            await move('#btn-new-single'); await click();
            document.getElementById('modal-single').classList.add('active');
            await sleep(500);
            await move('#input-title-1'); await click(); await type('#input-title-1', '测试环境搭建');
            await move('#btn-submit-1'); await click();
            document.getElementById('modal-single').classList.remove('active');
            
            const t1 = `<div class="task-card" style="animation: fadeIn 0.5s"><div class="priority-bar p-normal"></div><div class="task-col"><div class="task-project-name">未分类</div><div class="task-main-title">测试环境搭建</div><div class="task-tags"><span class="tag tag-doing">进行中</span></div></div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col"><div class="task-meta">刚刚</div><div class="task-actions"><button class="action-btn">编辑</button></div></div></div>`;
            document.getElementById('task-list-content').insertAdjacentHTML('afterbegin', t1);
            await sleep(1500);

            // 2. 新建周期任务
            sub("场景二：新建周期任务 (含自动化规则)");
            await move('#btn-new-recurring'); await click();
            document.getElementById('modal-recurring').classList.add('active');
            await sleep(500);
            await move('#input-title-2'); await click(); await type('#input-title-2', '机房巡检');
            await move('#btn-submit-2'); await click();
            document.getElementById('modal-recurring').classList.remove('active');
            
            const t2 = `<div class="task-card" style="animation: fadeIn 0.5s"><div class="priority-bar p-normal"></div><div class="task-col"><div class="task-project-name">未分类</div><div class="task-main-title">机房巡检 <i class="fas fa-sync" style="font-size:12px; color:#4f46e5"></i></div><div class="task-tags"><span class="tag tag-doing">进行中</span></div></div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col"><div class="task-meta">每周一</div><div class="task-actions"><button class="action-btn">编辑</button></div></div></div>`;
            document.getElementById('task-list-content').insertAdjacentHTML('afterbegin', t2);
            await sleep(2000);

            // 3. 项目切换
            sub("场景三：项目化管理，任务清晰分类");
            await move('#proj-1'); await click();
            document.querySelectorAll('.nav-item').forEach(e => e.classList.remove('active'));
            document.querySelectorAll('.project-card').forEach(e => e.style.background = 'rgba(255,255,255,0.5)');
            document.getElementById('proj-1').style.background = 'white';
            document.getElementById('proj-1').style.boxShadow = '0 2px 4px rgba(0,0,0,0.05)';
            
            // Content for Project 1 (Clean slate, only 1 task)
            const taskGroupHtml1 = `
                <div class="group-header"><div class="dot-red"></div> 紧急区 (逾期/今日)</div>
                <div class="task-card" style="animation: fadeIn 0.3s"><div class="priority-bar p-high"></div><div class="task-col"><div class="task-project-name">小组管理</div><div class="task-main-title">本周排班表确认</div><div class="task-tags"><span class="tag tag-doing">进行中</span></div></div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col"><div class="task-meta">截止 明天</div><div class="task-actions"><button class="action-btn">编辑</button></div></div></div>`;
            document.getElementById('task-list-content').innerHTML = taskGroupHtml1;
            document.querySelector('.page-meta').textContent = '共 1 条 · 按截止时间升序';
            await sleep(2000);

            await move('#proj-2'); await click();
            document.getElementById('proj-1').style.background = 'rgba(255,255,255,0.5)'; document.getElementById('proj-1').style.boxShadow = 'none';
            document.getElementById('proj-2').style.background = 'white'; document.getElementById('proj-2').style.boxShadow = '0 2px 4px rgba(0,0,0,0.05)';

            // Content for Project 2 (Mixed Priority)
            const taskGroupHtml2 = `
                <div class="group-header"><div class="dot-red"></div> 紧急区 (逾期/今日)</div>
                <div class="task-card" id="task-del-demo" style="animation: fadeIn 0.3s"><div class="priority-bar p-high"></div><div class="task-col"><div class="task-project-name">月度考核</div><div class="task-main-title">提交可服需求</div><div class="task-tags"><span class="tag tag-doing">进行中</span><span class="tag tag-high">高优</span></div></div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col"><div class="task-meta">逾期 2 天</div><div class="task-actions"><button class="action-btn">编辑</button><button class="action-btn btn-del" style="color:#ef4444; background:#fef2f2">删除</button></div></div></div>
                
                <div class="group-header" style="margin-top:30px;"><i class="fas fa-calendar icon-calendar"></i> 规划区 (未来)</div>
                <div class="task-card" style="animation: fadeIn 0.4s"><div class="priority-bar p-normal"></div><div class="task-col"><div class="task-project-name">月度考核</div><div class="task-main-title">提交文档需求</div><div class="task-tags"><span class="tag tag-doing">进行中</span></div></div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col" style="font-size:12px;color:#6b7280">撰写维护经验文档...</div><div class="task-col"><div class="task-meta">剩余 28 天</div><div class="task-actions"><button class="action-btn">编辑</button></div></div></div>`;
            document.getElementById('task-list-content').innerHTML = taskGroupHtml2;
            document.querySelector('.page-meta').textContent = '共 2 条 · 按截止时间升序';
            await sleep(1500);

            // === 4. 筛选演示 (Refined) ===
            sub("场景四：多维度筛选，精准定位");
            
            await move('#filter-priority', 1000);
            await click();
            document.getElementById('filter-priority').classList.add('active');
            document.getElementById('dropdown-priority').classList.add('show');
            await sleep(1000);

            await move('#option-high', 800);
            document.getElementById('option-high').classList.add('hover'); 
            await sleep(500);

            await click();
            document.getElementById('filter-priority').textContent = "高"; 
            document.getElementById('filter-priority').style.color = "#4f46e5";
            document.getElementById('filter-priority').style.fontWeight = "600";
            document.getElementById('dropdown-priority').classList.remove('show');
            document.getElementById('option-high').classList.remove('hover');
            document.getElementById('option-high').classList.add('selected');
            document.getElementById('filter-priority').classList.remove('active'); 
            
            // LOGIC FIX: Replace EVERYTHING in the list with ONLY the high priority task
            document.getElementById('task-list-content').innerHTML = `
                 <div class="group-header"><div class="dot-red"></div> 紧急区 (逾期/今日)</div>
                 <div class="task-card" style="animation: fadeIn 0.3s"><div class="priority-bar p-high"></div><div class="task-col"><div class="task-project-name">月度考核</div><div class="task-main-title">提交可服需求</div><div class="task-tags"><span class="tag tag-doing">进行中</span><span class="tag tag-high">高优</span></div></div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col"><div class="task-meta">逾期 2 天</div><div class="task-actions"><button class="action-btn">编辑</button><button class="action-btn btn-del" style="color:#ef4444; background:#fef2f2">删除</button></div></div></div>
                 <!-- Planning Area is GONE because no high priority tasks there -->`;
            document.querySelector('.page-meta').textContent = '共 1 条 · 筛选结果 (优先级: 高)';
            await sleep(2000);
            
            // Clear Filter
            await move('.clear-filter', 800);
            document.querySelector('.clear-filter').style.textDecoration = 'underline';
            await sleep(300);
            await click();
            document.querySelector('.clear-filter').style.textDecoration = 'none';
            
            // Reset UI
            document.getElementById('filter-priority').textContent = "全部";
            document.getElementById('filter-priority').style.color = "#374151";
            document.getElementById('filter-priority').style.fontWeight = "normal";
            document.getElementById('option-high').classList.remove('selected');
            
            // Restore Full Project 2 View
            document.getElementById('task-list-content').innerHTML = taskGroupHtml2;
            document.querySelector('.page-meta').textContent = '共 2 条 · 按截止时间升序';
            await sleep(1500);

            // === 5. 删除与回收站 ===
            sub("场景五：任务删除与回收站恢复");
            await move('.btn-del'); await click();
            
            const delTask = document.getElementById('task-del-demo');
            delTask.style.transform = 'translateX(100px)'; delTask.style.opacity = '0';
            await sleep(300);
            delTask.remove();
            showToast('已移入回收站');
            document.querySelector('.nav-count').textContent = '6 项';
            document.querySelectorAll('.nav-count')[2].textContent = '1 项'; // Trash count
            await sleep(1500);

            await move('#nav-trash'); await click();
            document.querySelectorAll('.nav-item').forEach(e => e.classList.remove('active'));
            document.getElementById('nav-trash').classList.add('active');
            document.getElementById('proj-2').style.background = 'rgba(255,255,255,0.5)'; document.getElementById('proj-2').style.boxShadow = 'none';

            document.querySelector('.page-title').innerHTML = '回收站 <span class="page-meta">共 1 条</span>';
            document.getElementById('task-list-content').innerHTML = `
                <div class="task-card" id="task-recover-demo" style="opacity:0.7; filter:grayscale(1);"><div class="priority-bar" style="background:#9ca3af"></div><div class="task-col"><div class="task-project-name">月度考核</div><div class="task-main-title" style="text-decoration:line-through">提交可服需求</div><div class="task-tags"><span class="tag" style="border:1px solid #ccc; color:#999">已删除</span></div></div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col text-placeholder">--</div><div class="task-col"><div class="task-actions"><button class="action-btn btn-recover" style="color:#4f46e5; background:#eef2ff">恢复任务</button></div></div></div>`;
            await sleep(1500);

            await move('.btn-recover'); await click();
            const recTask = document.getElementById('task-recover-demo');
            recTask.style.transform = 'translateY(-20px)'; recTask.style.opacity = '0';
            await sleep(300);
            recTask.remove();
            showToast('任务已恢复');
            document.querySelectorAll('.nav-count')[2].textContent = '0 项';
            document.getElementById('task-list-content').innerHTML = `<div style="padding:40px; text-align:center; color:#9ca3af">回收站为空</div>`;
            await sleep(1500);

            // 6. 主题切换
            sub("场景六：8款预设主题，随心切换");
            await move('#btn-theme'); await click();
            document.getElementById('modal-theme').classList.add('active');
            await sleep(1000); 
            
            // Smoothly move to first theme
            await move('#theme-rose', 1000); 
            await click();
            document.querySelectorAll('.theme-item').forEach(el=>el.classList.remove('active'));
            document.getElementById('theme-rose').classList.add('active');
            document.body.setAttribute('data-theme', 'rose');
            await sleep(1800); 

            // Smoothly move to second theme
            await move('#theme-indigo', 1000); 
            await click();
            document.querySelectorAll('.theme-item').forEach(el=>el.classList.remove('active'));
            document.getElementById('theme-indigo').classList.add('active');
            document.body.setAttribute('data-theme', 'indigo');
            await sleep(1800); 
            
            // Close modal and wait
            document.getElementById('modal-theme').classList.remove('active');
            
            // Move cursor out of the way to show full UI
            cursor.style.left = '110%'; cursor.style.top = '50%';
            await sleep(2000); 

            document.getElementById('window').style.opacity = '0';
            document.getElementById('window').style.transform = 'scale(0.9)';
            subtitle.style.opacity = '0';
            await sleep(800); 

            await playOutro();
        }
        window.onload = run;
        document.addEventListener('dblclick', () => location.reload());
    </script>
    <style>@keyframes fadeIn { from { opacity:0; transform:translateY(5px); } to { opacity:1; transform:translateY(0); } }</style>
</body>
</html>
