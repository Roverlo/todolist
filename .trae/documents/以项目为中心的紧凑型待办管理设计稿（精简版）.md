## 目标与范围
- 目标：按“项目→事项”管理，支持高效筛选、紧凑表格视图与全流程跟踪。
- 范围：项目与事项的创建/编辑/筛选/分组/导入导出/批量操作。
- 非目标：不做复盘、番茄钟、情绪打分、周月报等（保持极简）。

## 信息架构与UI
- 左侧：项目列表（支持创建、重命名、归档、搜索）。
- 顶部：搜索框、筛选器（项目/状态/责任人/截止期/标签）、排序、导入/导出、批量操作按钮。
- 主区：任务表格（紧凑密度，行内编辑，支持列自定义与固定）。
- 右侧（可选）：详情抽屉（备注/附件/历史记录），默认关闭以保持紧凑。
- 表格默认列：
  - 项目（`project`）
  - 标题（`title`）
  - 状态（`status`: todo/doing/done）
  - 优先级（`priority`: high/medium/low）
  - 截止日（`dueDate`）
  - 创建时间（`createdAt`）
  - 任务现场责任人（`onsiteOwner`）
  - 任务产线责任人（`lineOwner`）
  - 下一步计划（`nextStep`）
  - 标签（`tags`）
- 交互：
  - 快速新增行（键入标题后可选字段自动补齐）。
  - 行内编辑、键盘导航（↑↓、Enter 编辑、Ctrl+S 保存）。
  - 多选行批量修改（状态/责任人/截止日/项目）。
  - 过滤：支持保存筛选（如“本周到期”、“张三负责的进行中”）。
  - 分组：按项目或状态分组，展开/折叠计数显示。

## 功能模块与规则
- 项目管理：新增/重命名/归档，归档项目不在默认筛选中显示。
- 事项管理：CRUD、复制为新事项、移动到其他项目。
- 筛选与排序：
  - 筛选字段：项目、状态、责任人（现场/产线）、截止期范围、标签、优先级。
  - 排序：截止日/优先级/创建时间；支持多列排序（优先按状态→截止日）。
- 逾期与提醒：仅在表格中高亮逾期行；不做通知系统。
- 批量操作：批量移动项目、批量改责任人/状态/截止日。
- 导入导出：
  - 导入 CSV：映射到表头；未提供列使用默认值（如 status=todo）。
  - 导出 CSV：遵循当前列顺序与筛选结果；支持全量导出。
- 权限与隐私：本地数据，单人使用；不含团队分享功能。

## 数据结构
```ts
type Status = 'todo'|'doing'|'done';
type Priority = 'high'|'medium'|'low';

type Project = {
  id: string;
  name: string;
  archived?: boolean;
  createdAt: number;
  updatedAt: number;
};

type Task = {
  id: string;
  projectId: string;
  title: string;
  status: Status;
  priority?: Priority;
  dueDate?: string;       // ISO date
  createdAt: number;
  updatedAt: number;
  onsiteOwner?: string;
  lineOwner?: string;
  nextStep?: string;
  tags?: string[];
  attachments?: { id:string; name:string; path:string }[]; // 可选
  notes?: string;          // 备注，可选
};

type AppState = {
  projects: Project[];
  tasks: Task[];
  filters: {
    search: string;
    projectId?: string;
    status?: Status|"all";
    onsiteOwner?: string;
    lineOwner?: string;
    dueRange?: { from?: string; to?: string };
    tags?: string[];
    priority?: Priority|"all";
  };
  table: { density: 'compact'|'normal'; columns: string[]; pinned: string[] };
  settings: { dateFormat: string };
};
```

## CSV 规范
- 列：`project,title,status,priority,dueDate,createdAt,onsiteOwner,lineOwner,nextStep,tags`
- 导入规则：
  - `project` 未匹配则创建新项目；`status` 非法值回退到 `todo`；
  - `tags` 逗号分隔；`createdAt` 空则由系统生成当前时间。
- 导出规则：
  - 按当前筛选与列顺序导出；日期统一 `YYYY-MM-DD`；
  - 空值导出为空字符串。

## 非功能与成功指标
- 操作效率：新增事项≤2步，行内编辑一次击键保存。
- 过滤准确性：组合筛选毫秒级反馈，逾期高亮清晰可见。
- 导入导出一致性：两次导入后不产生重复或丢字段（基于 `id` 与列映射）。

## 实施计划
1. 用本设计替换现有 `design.md` 内容（移除复盘/番茄/日志等章节）。
2. 重写“信息架构/模块/数据结构/CSV规范/约束”章节为上述精简版本。
3. 验证：以两份示例 CSV 完成导入/导出自检，确保字段映射与筛选生效。

## 交付
- 产出：简洁紧凑、项目为中心的待办产品设计稿（单文件）。
- 不变更其他文件（仅更新设计稿内容）。